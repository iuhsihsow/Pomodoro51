C51 COMPILER V8.08   POMODORO51                                                            05/10/2016 13:22:20 PAGE 1   


C51 COMPILER V8.08, COMPILATION OF MODULE POMODORO51
OBJECT MODULE PLACED IN ..\bin\pomodoro51.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE pomodoro51.c BROWSE DEBUG OBJECTEXTEND OBJECT(..\bin\pomodoro51.obj)

line level    source

   1          #include <reg52.h>
   2          #include <intrins.h>
   3          #define uchar unsigned char
   4          #define uint  unsigned int
   5          sbit we = P2^7;
   6          sbit du = P2^6;
   7          sbit beep = P2^3;
   8          sbit LED1 = P1^0;
   9          uchar counter;
  10          uint time_counter = 1500;
  11          uint rest_counter = 300;
  12          uint status = 0; // 0 for  work, 1 for rest
  13          uint current_counter = 0;
  14          
  15          
  16          unsigned char code wei[]=
  17          {0xfe,0xfd,0xfb,0xf7,0xef,0xdf,0xbf,0x7f}; //数码管各位的码表
  18          
  19          uchar code leddata[]={ 
  20           
  21                          0x3F,  //"0"
  22                          0x06,  //"1"
  23                          0x5B,  //"2"
  24                          0x4F,  //"3"
  25                          0x66,  //"4"
  26                          0x6D,  //"5"
  27                          0x7D,  //"6"
  28                          0x07,  //"7"
  29                          0x7F,  //"8"
  30                          0x6F,  //"9"
  31                          0x77,  //"A"
  32                          0x7C,  //"B"
  33                          0x39,  //"C"
  34                          0x5E,  //"D"
  35                          0x79,  //"E"
  36                          0x71,  //"F"
  37                          0x76,  //"H"
  38                          0x38,  //"L"
  39                          0x37,  //"n"
  40                          0x3E,  //"u"
  41                          0x73,  //"P"
  42                          0x5C,  //"o"
  43                          0x40,  //"-"
  44                          0x00,  //熄灭
  45                          0x00  //自定义
  46           
  47                                   };
  48          
  49          void delay(uint z)
  50          {
  51   1              uint x,y;
  52   1              for(x = z; x > 0; x--)
  53   1                      for(y = 114; y > 0 ; y--);
  54   1      }
  55          
C51 COMPILER V8.08   POMODORO51                                                            05/10/2016 13:22:20 PAGE 2   

  56          void display(uint i)
  57          {
  58   1              uint qian, bai, shi, ge;
  59   1              qian = i / 1000;
  60   1      
  61   1              bai = i % 1000;
  62   1              bai = bai / 100;
  63   1      
  64   1              shi = i % 100; 
  65   1              shi = shi / 10;
  66   1      
  67   1              ge  = i % 10; //求余
  68   1      
  69   1              P0 = 0xff;
  70   1              we = 1;
  71   1              P0 = wei[0]; //点亮第一位数码管
  72   1              we = 0;
  73   1      
  74   1              du = 1;
  75   1              P0 = leddata[qian];
  76   1              du = 0;
  77   1              delay(1);
  78   1      
  79   1              P0 = 0xff;
  80   1              we = 1;
  81   1              P0 = wei[1];//点亮第二位数码管
  82   1              we = 0;
  83   1      
  84   1              du = 1;
  85   1              P0 = leddata[bai];
  86   1              du = 0;
  87   1              delay(1);       
  88   1      
  89   1              P0 = 0xff;
  90   1              we = 1;
  91   1              P0 = wei[2];//点亮第3w
  92   1              we = 0;
  93   1      
  94   1              du = 1;
  95   1              P0 = leddata[shi];
  96   1              du = 0;
  97   1              delay(1);
  98   1      
  99   1      
 100   1          P0 = 0xff;
 101   1              we = 1;
 102   1              P0 = wei[3];//点亮第二位数码管
 103   1              we = 0;
 104   1      
 105   1              du = 1;
 106   1              P0 = leddata[ge];
 107   1              du = 0;
 108   1              delay(1);
 109   1      }
 110          
 111          void displayLow(uint i)
 112          {
 113   1              uint qian, bai, shi, ge;
 114   1              qian = i / 1000;
 115   1      
 116   1              bai = i % 1000;
 117   1              bai = bai / 100;
C51 COMPILER V8.08   POMODORO51                                                            05/10/2016 13:22:20 PAGE 3   

 118   1      
 119   1              shi = i % 100; 
 120   1              shi = shi / 10;
 121   1      
 122   1              ge  = i % 10; //求余
 123   1      
 124   1              P0 = 0xff;
 125   1              we = 1;
 126   1              P0 = wei[4]; //点亮第一位数码管
 127   1              we = 0;
 128   1      
 129   1              du = 1;
 130   1              P0 = leddata[qian];
 131   1              du = 0;
 132   1              delay(1);
 133   1      
 134   1              P0 = 0xff;
 135   1              we = 1;
 136   1              P0 = wei[5];//点亮第二位数码管
 137   1              we = 0;
 138   1      
 139   1              du = 1;
 140   1              P0 = leddata[bai];
 141   1              du = 0;
 142   1              delay(1);       
 143   1      
 144   1              P0 = 0xff;
 145   1              we = 1;
 146   1              P0 = wei[6];//点亮第3w
 147   1              we = 0;
 148   1      
 149   1              du = 1;
 150   1              P0 = leddata[shi];
 151   1              du = 0;
 152   1              delay(1);
 153   1      
 154   1      
 155   1          P0 = 0xff;
 156   1              we = 1;
 157   1              P0 = wei[7];//点亮第二位数码管
 158   1              we = 0;
 159   1      
 160   1              du = 1;
 161   1              P0 = leddata[ge];
 162   1              du = 0;
 163   1              delay(1);
 164   1      }
 165          
 166          void Beeeeeep(uint times)
 167          {
 168   1        uint total = 0;
 169   1        while( total < times )
 170   1        {
 171   2                      total ++;
 172   2                      beep = ~beep;
 173   2                      delay(200);
 174   2                      beep = ~beep;
 175   2                      delay(800);
 176   2      
 177   2        }
 178   1      
 179   1      }
C51 COMPILER V8.08   POMODORO51                                                            05/10/2016 13:22:20 PAGE 4   

 180          
 181          void main()
 182          {
 183   1              TMOD = 0x01;//定时器0 工作模式1 16模式定时器
 184   1              TH0 = (65536 - 46082)/256;
 185   1              TL0 = (65536 - 46082)%256; //定时50ms
 186   1              TR0 = 1;
 187   1              current_counter = time_counter;
 188   1      
 189   1              while(1)
 190   1              {
 191   2                      if(TF0 == 1)
 192   2                      {
 193   3                              TF0 = 0;
 194   3                              TH0 = 0x4b;
 195   3                              TL0 = 0xfe; //定时50ms
 196   3                              counter++;
 197   3                      }
 198   2                      if(counter == 20)
 199   2                      {
 200   3                              counter = 0;
 201   3                              //LED1 = ~LED1;
 202   3                              current_counter--;
 203   3                      }
 204   2      
 205   2                      if(current_counter == 0)
 206   2                      {
 207   3                              Beeeeeep(3);
 208   3                              if(status == 1){
 209   4                              status = 0;}
 210   3                              else if(status == 0){
 211   4                              status = 1;}
 212   3                              if(status == 0){
 213   4                              current_counter = time_counter;}
 214   3                              else if(status ==  1){
 215   4                              current_counter = rest_counter;}
 216   3                      }
 217   2                      if(status == 0){
 218   3                      display(current_counter);}
 219   2                      else if(status == 1){
 220   3                      displayLow(current_counter);}
 221   2              }
 222   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    595    ----
   CONSTANT SIZE    =     33    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      9      12
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
