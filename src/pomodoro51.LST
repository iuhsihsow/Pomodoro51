C51 COMPILER V8.08   POMODORO51                                                            05/11/2016 11:04:10 PAGE 1   


C51 COMPILER V8.08, COMPILATION OF MODULE POMODORO51
OBJECT MODULE PLACED IN ..\bin\pomodoro51.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE pomodoro51.c BROWSE DEBUG OBJECTEXTEND OBJECT(..\bin\pomodoro51.obj)

line level    source

   1          #include <reg52.h>
   2          #include <intrins.h>
   3          #define uchar unsigned char
   4          #define uint  unsigned int
   5          sbit we = P2^7;
   6          sbit du = P2^6;
   7          sbit beep = P2^3;
   8          sbit LED1 = P1^0;
   9          uchar counter;
  10          uint time_counter = 1500;
  11          uint rest_counter = 300;
  12          uint status = 0; // 0 for  work, 1 for rest
  13          uint current_counter = 0;
  14          uint beep_times = 2;
  15          
  16          
  17          unsigned char code wei[]=
  18          {0xfe,0xfd,0xfb,0xf7,0xef,0xdf,0xbf,0x7f}; //数码管各位的码表
  19          
  20          uchar code leddata[]={ 
  21           
  22                          0x3F,  //"0"
  23                          0x06,  //"1"
  24                          0x5B,  //"2"
  25                          0x4F,  //"3"
  26                          0x66,  //"4"
  27                          0x6D,  //"5"
  28                          0x7D,  //"6"
  29                          0x07,  //"7"
  30                          0x7F,  //"8"
  31                          0x6F,  //"9"
  32                          0x77,  //"A"
  33                          0x7C,  //"B"
  34                          0x39,  //"C"
  35                          0x5E,  //"D"
  36                          0x79,  //"E"
  37                          0x71,  //"F"
  38                          0x76,  //"H"
  39                          0x38,  //"L"
  40                          0x37,  //"n"
  41                          0x3E,  //"u"
  42                          0x73,  //"P"
  43                          0x5C,  //"o"
  44                          0x40,  //"-"
  45                          0x00,  //熄灭
  46                          0x00  //自定义
  47           
  48                                   };
  49          
  50          void delay(uint z)
  51          {
  52   1              uint x,y;
  53   1              for(x = z; x > 0; x--)
  54   1                      for(y = 114; y > 0 ; y--);
  55   1      }
C51 COMPILER V8.08   POMODORO51                                                            05/11/2016 11:04:10 PAGE 2   

  56          
  57          void display(uint i)
  58          {
  59   1              uint qian, bai, shi, ge;
  60   1              qian = i / 1000;
  61   1      
  62   1              bai = i % 1000;
  63   1              bai = bai / 100;
  64   1      
  65   1              shi = i % 100; 
  66   1              shi = shi / 10;
  67   1      
  68   1              ge  = i % 10; //求余
  69   1      
  70   1              P0 = 0xff;
  71   1              we = 1;
  72   1              P0 = wei[0]; //点亮第一位数码管
  73   1              we = 0;
  74   1      
  75   1              du = 1;
  76   1              P0 = leddata[qian];
  77   1              du = 0;
  78   1              delay(1);
  79   1      
  80   1              P0 = 0xff;
  81   1              we = 1;
  82   1              P0 = wei[1];//点亮第二位数码管
  83   1              we = 0;
  84   1      
  85   1              du = 1;
  86   1              P0 = leddata[bai];
  87   1              du = 0;
  88   1              delay(1);       
  89   1      
  90   1              P0 = 0xff;
  91   1              we = 1;
  92   1              P0 = wei[2];//点亮第3w
  93   1              we = 0;
  94   1      
  95   1              du = 1;
  96   1              P0 = leddata[shi];
  97   1              du = 0;
  98   1              delay(1);
  99   1      
 100   1      
 101   1          P0 = 0xff;
 102   1              we = 1;
 103   1              P0 = wei[3];//点亮第二位数码管
 104   1              we = 0;
 105   1      
 106   1              du = 1;
 107   1              P0 = leddata[ge];
 108   1              du = 0;
 109   1              delay(1);
 110   1      }
 111          
 112          void displayLow(uint i)
 113          {
 114   1              uint qian, bai, shi, ge;
 115   1              qian = i / 1000;
 116   1      
 117   1              bai = i % 1000;
C51 COMPILER V8.08   POMODORO51                                                            05/11/2016 11:04:10 PAGE 3   

 118   1              bai = bai / 100;
 119   1      
 120   1              shi = i % 100; 
 121   1              shi = shi / 10;
 122   1      
 123   1              ge  = i % 10; //求余
 124   1      
 125   1              P0 = 0xff;
 126   1              we = 1;
 127   1              P0 = wei[4]; //点亮第一位数码管
 128   1              we = 0;
 129   1      
 130   1              du = 1;
 131   1              P0 = leddata[qian];
 132   1              du = 0;
 133   1              delay(1);
 134   1      
 135   1              P0 = 0xff;
 136   1              we = 1;
 137   1              P0 = wei[5];//点亮第二位数码管
 138   1              we = 0;
 139   1      
 140   1              du = 1;
 141   1              P0 = leddata[bai];
 142   1              du = 0;
 143   1              delay(1);       
 144   1      
 145   1              P0 = 0xff;
 146   1              we = 1;
 147   1              P0 = wei[6];//点亮第3w
 148   1              we = 0;
 149   1      
 150   1              du = 1;
 151   1              P0 = leddata[shi];
 152   1              du = 0;
 153   1              delay(1);
 154   1      
 155   1      
 156   1          P0 = 0xff;
 157   1              we = 1;
 158   1              P0 = wei[7];//点亮第二位数码管
 159   1              we = 0;
 160   1      
 161   1              du = 1;
 162   1              P0 = leddata[ge];
 163   1              du = 0;
 164   1              delay(1);
 165   1      }
 166          
 167          void Beeeeeep(uint times)
 168          {
 169   1        uint total = 0;
 170   1        while( total < times )
 171   1        {
 172   2                      total ++;
 173   2                      beep = ~beep;
 174   2                      delay(200);
 175   2                      beep = ~beep;
 176   2                      delay(800);
 177   2      
 178   2        }
 179   1      
C51 COMPILER V8.08   POMODORO51                                                            05/11/2016 11:04:10 PAGE 4   

 180   1      }
 181          
 182          void main()
 183          {
 184   1              TMOD = 0x01;//定时器0 工作模式1 16模式定时器
 185   1              TH0 = (65536 - 46082)/256;
 186   1              TL0 = (65536 - 46082)%256; //定时50ms
 187   1              TR0 = 1;
 188   1              current_counter = time_counter;
 189   1      
 190   1              while(1)
 191   1              {
 192   2                      if(TF0 == 1)
 193   2                      {
 194   3                              TF0 = 0;
 195   3                              TH0 = 0x4b;
 196   3                              TL0 = 0xfe; //定时50ms
 197   3                              counter++;
 198   3                      }
 199   2                      if(counter == 20)
 200   2                      {
 201   3                              counter = 0;
 202   3                              //LED1 = ~LED1;
 203   3                              current_counter--;
 204   3                      }
 205   2      
 206   2                      if(current_counter == 0)
 207   2                      {
 208   3                              Beeeeeep(beep_times);
 209   3                              if(status == 1){
 210   4                              status = 0;}
 211   3                              else if(status == 0){
 212   4                              status = 1;}
 213   3                              if(status == 0){
 214   4                              current_counter = time_counter;}
 215   3                              else if(status ==  1){
 216   4                              current_counter = rest_counter;}
 217   3                      }
 218   2                      if(status == 0){
 219   3                      display(current_counter);}
 220   2                      else if(status == 1){
 221   3                      displayLow(current_counter);}
 222   2              }
 223   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    596    ----
   CONSTANT SIZE    =     33    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     11      12
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
